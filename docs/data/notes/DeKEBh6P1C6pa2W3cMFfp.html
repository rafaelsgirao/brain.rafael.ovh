<h1 id="lambdajail"><a aria-hidden="true" class="anchor-heading" href="#lambdajail"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Lambdajail</h1>
<p>This one seems tricky.</p>
<p>You're given NC access to interactive python with a message saying <code>** import os and get a sh! should be easy ;) **</code></p>
<p>First thing that crosses your mind is doing that. But you're greeted with an awful message:</p>
<pre><code>>>> import os
Nope...
>>>
</code></pre>
<p>Turns out a lot of special keywords are filtered. A non exhaustive list of these:
<code>import, def, if, else, class, =, builtin, dict, ... and many others.</code></p>
<p><a href="https://lbarman.ch/blog/pyjail/">This post</a> encouraged me to try to smash my keyboard and see what I could find. </p>
<p>Some interesting things:</p>
<ul>
<li>any Error (e.g <code>ZeroDivisionError</code>, <code>ValueError</code>) is filtered to show up as just <code>Error</code> ;</li>
<li>Undefined things are spit out as <code>Error:  name 'x' is not defined</code></li>
<li>Some keywords such as <code>pass</code>, <code>for</code> <em>don't</em> spit out as undefined</li>
<li>Typing a <code>\</code> on the prompt reveals <code>Error:  unexpected EOF while parsing (&#x3C;string>, line 1)</code></li>
<li>Typing <code>\\</code> on the prompt reveals <code>Error:  unexpected character after line continuation character (&#x3C;string>, line 1)</code></li>
</ul>
<p>"This is a very long potato that doesn't fit" \
"on a single line"</p>
<h3 id="todo"><a aria-hidden="true" class="anchor-heading" href="#todo"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>TODO</h3>
<pre><code>>>> [x.func_code for x in [lambda: "test"]]
Result: [&#x3C;code object &#x3C;lambda> at 0x7fceed4797b0, file "&#x3C;string>", line 1>]
>>>
</code></pre>
<p>Ideia: redefinir o <code>__class__</code> de uma função com o <code>_setattr__</code> para poder passar a ter uma classe
Ou então redefinir o <strong>name</strong> para cenas</p>
<h2 id="external-references-used"><a aria-hidden="true" class="anchor-heading" href="#external-references-used"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>External references used</h2>
<ul>
<li><a href="https://titanwolf.org/Network/Articles/Article?AID=fc8539b6-c4d1-4735-b60b-846d40bf8fa2">https://titanwolf.org/Network/Articles/Article?AID=fc8539b6-c4d1-4735-b60b-846d40bf8fa2</a></li>
<li><a href="https://book.hacktricks.xyz/misc/basic-python/bypass-python-sandboxes">https://book.hacktricks.xyz/misc/basic-python/bypass-python-sandboxes</a></li>
<li><a href="https://github.com/mahaloz/ctf-wiki-en/blob/master/docs/pwn/linux/sandbox/python-sandbox-escape.md">https://github.com/mahaloz/ctf-wiki-en/blob/master/docs/pwn/linux/sandbox/python-sandbox-escape.md</a></li>
<li><a href="https://lbarman.ch/blog/pyjail/">https://lbarman.ch/blog/pyjail/</a></li>
<li><a href="https://nedbatchelder.com/blog/201302/finding_python_3_builtins.html">https://nedbatchelder.com/blog/201302/finding_python_3_builtins.html</a></li>
<li><a href="https://stackoverflow.com/questions/13307110/can-you-recover-from-reassigning-builtins-in-python">https://stackoverflow.com/questions/13307110/can-you-recover-from-reassigning-builtins-in-python</a></li>
<li><a href="https://stackoverflow.com/questions/15404256/changing-the-class-of-a-python-object-casting">https://stackoverflow.com/questions/15404256/changing-the-class-of-a-python-object-casting</a></li>
</ul>
<p>[x for x in [lambda: "test"]][0].func_code</p>
<p>[lambda: "teste"][0]</p>
<hr>
<h2 id="children"><a aria-hidden="true" class="anchor-heading" href="#children"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Children</h2>
<ol>
<li><a href="/notes/cH5aYo0IMwCRz99syYH6D">Page</a></li>
</ol>